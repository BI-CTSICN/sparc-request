- if (@sub_service_request.nil? ? @service_request.documents.size >= 1 : @sub_service_request.documents.size >= 1)
  %table.document-table
    - if review
      %tr
        %th.light-blue-provider{:colspan => 3} Document Uploads
    %tr.header
      %th Institution/Provider/Program/Core
      %th Type
      %th Title
      - if not review
        %th Actions

    - @service_request.documents.group_by(&:document_grouping_id).each do |grouping_id, docs|
      - next unless @sub_service_request.nil? or docs.map(&:sub_service_request_id).include?(@sub_service_request.id)
      - doc = docs.first
      %tr.document{:id => "document_grouping_#{grouping_id}"}
        %td{:style => "text-align:left"}
          - docs.each do |document|
            - next unless @sub_service_request.nil? or @sub_service_request.organization.name == document.sub_service_request.organization.name
            = @service_list[document.sub_service_request.organization_id][:name]
            %br
        %td= doc.display_document_type
        %td= link_to doc.document_file_name, doc.document.url
        - if not review
          %td
            = link_to "Edit", "/service_requests/#{@service_request.id}/edit_document_group/#{grouping_id}", :remote => true, :class => 'document_edit'
            = link_to "Delete", "/service_requests/#{@service_request.id}/delete_document_group/#{grouping_id}", :remote => true, :class => 'document_delete'
- else
  %div No documents found
